<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎯 AI プレゼン資料ジェネレーター</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'noto': ['Noto Sans JP', 'Arial', 'Helvetica', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        html, body {
            font-family: 'Noto Sans JP', Arial, Helvetica, sans-serif;
            height: auto;
            overflow-x: hidden;
            overflow-y: auto;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .glass-effect:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        
        .glass-card:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.25);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
            transform: translateY(-1px);
        }
        
        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% 200%;
            animation: gradientShift 4s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }
        
        .neon-glow {
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3),
                        0 0 40px rgba(102, 126, 234, 0.2),
                        0 0 60px rgba(102, 126, 234, 0.1);
        }
        
        .slide-in {
            animation: slideIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 relative">
    <!-- Background Effects -->
    <div class="fixed inset-0 opacity-30 pointer-events-none">
        <div class="absolute inset-0" style="background-image: radial-gradient(circle at 25px 25px, #4F46E5 2px, transparent 0); background-size: 50px 50px;"></div>
    </div>
    <div class="absolute top-20 left-20 w-72 h-72 bg-blue-400/10 rounded-full blur-3xl animate-pulse"></div>
    <div class="absolute bottom-20 right-20 w-96 h-96 bg-purple-400/10 rounded-full blur-3xl animate-pulse" style="animation-delay: 1s;"></div>
    
    <div class="container mx-auto px-4 py-8 pb-16 relative z-10">
        <div class="max-w-5xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-12 relative">
                <div class="absolute inset-0 bg-gradient-to-r from-blue-400/10 via-purple-400/10 to-pink-400/10 blur-3xl rounded-full scale-150 floating-animation"></div>
                <div class="relative z-10">
                    <h1 class="text-5xl md:text-6xl font-bold gradient-text mb-6 leading-tight">
                        🎯 AI プレゼン資料ジェネレーター
                    </h1>
                    <p class="text-gray-600 text-xl md:text-2xl font-medium leading-relaxed max-w-3xl mx-auto">
                        最新のAI技術で、プロフェッショナルなプレゼンテーション構成を自動生成
                    </p>
                    <div class="flex justify-center mt-8 space-x-6">
                        <div class="flex items-center text-gray-600">
                            <div class="w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"></div>
                            <span class="font-medium">✨ AIパワード</span>
                        </div>
                        <div class="flex items-center text-gray-600">
                            <div class="w-3 h-3 bg-blue-500 rounded-full mr-2 animate-pulse" style="animation-delay: 0.5s;"></div>
                            <span class="font-medium">⚡ 高速生成</span>
                        </div>
                        <div class="flex items-center text-gray-600">
                            <div class="w-3 h-3 bg-purple-500 rounded-full mr-2 animate-pulse" style="animation-delay: 1s;"></div>
                            <span class="font-medium">🎨 プロ級</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form -->
            <div id="form-container" class="slide-in">
                <form id="presentationForm" class="space-y-6 p-6 glass-effect relative overflow-hidden max-w-2xl mx-auto">
                    <!-- Header -->
                    <div class="text-center mb-8 relative">
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-400/20 to-purple-400/20 blur-3xl rounded-full scale-150 floating-animation"></div>
                        <div class="flex items-center justify-center mb-4 relative z-10">
                            <div class="p-3 rounded-2xl bg-gradient-to-r from-blue-500 to-purple-600 mr-3 neon-glow">
                                <span class="text-white text-2xl">✨</span>
                            </div>
                            <h2 class="text-3xl font-bold gradient-text">
                                AI プレゼン資料ジェネレーター
                            </h2>
                        </div>
                        <p class="text-gray-600 text-lg relative z-10">テーマを入力するだけで、プロフェッショナルなプレゼン構成を自動生成</p>
                    </div>

                    <!-- Theme Input -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-400/20 to-purple-400/20 blur-xl rounded-3xl group-hover:blur-2xl transition-all duration-300"></div>
                        <div class="relative bg-white/40 backdrop-blur-md border border-white/30 rounded-3xl p-5">
                            <label class="block text-sm font-bold text-gray-800 mb-3 flex items-center">
                                <div class="w-7 h-7 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mr-2">
                                    <span class="text-white text-sm">✨</span>
                                </div>
                                プレゼンテーマ・目的 *
                            </label>
                            <div class="relative">
                                <input
                                    type="text"
                                    id="theme"
                                    required
                                    placeholder="例: 新システム導入提案、四半期売上報告"
                                    class="w-full pl-4 pr-10 py-3 bg-white/70 border border-white/40 rounded-2xl focus:ring-3 focus:ring-blue-500/30 focus:border-blue-400 focus:bg-white/90 transition-all duration-300 text-gray-800 placeholder-gray-500 backdrop-blur-sm font-medium shadow-sm text-sm"
                                />
                                <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                                    <span class="text-lg">📝</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Compact Fields Grid -->
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
                        <!-- Audience -->
                        <div class="group relative">
                            <div class="absolute inset-0 bg-gradient-to-r from-blue-400/10 to-cyan-400/10 blur-lg rounded-2xl group-hover:blur-md transition-all duration-300"></div>
                            <div class="relative bg-white/30 backdrop-blur-sm border border-white/40 rounded-2xl p-3 hover:bg-white/50 transition-all duration-300">
                                <label class="block text-xs font-semibold text-gray-700 mb-2 flex items-center">
                                    <span class="text-blue-500 text-sm mr-1">👥</span>
                                    対象者
                                </label>
                                <select id="audience" class="w-full px-2 py-1.5 bg-transparent border-none rounded-xl focus:ring-2 focus:ring-blue-400/30 transition-all duration-300 text-xs text-gray-800 appearance-none cursor-pointer font-medium">
                                    <option value="">選択</option>
                                    <option value="役員・経営陣">👔 役員</option>
                                    <option value="チーム・同僚">🤝 チーム</option>
                                    <option value="顧客・クライアント">🎯 顧客</option>
                                    <option value="一般向け">👥 一般</option>
                                </select>
                            </div>
                        </div>

                        <!-- Duration -->
                        <div class="group relative">
                            <div class="absolute inset-0 bg-gradient-to-r from-green-400/10 to-teal-400/10 blur-lg rounded-2xl group-hover:blur-md transition-all duration-300"></div>
                            <div class="relative bg-white/30 backdrop-blur-sm border border-white/40 rounded-2xl p-3 hover:bg-white/50 transition-all duration-300">
                                <label class="block text-xs font-semibold text-gray-700 mb-2 flex items-center">
                                    <span class="text-green-500 text-sm mr-1">⏰</span>
                                    時間
                                </label>
                                <select id="duration" class="w-full px-2 py-1.5 bg-transparent border-none rounded-xl focus:ring-2 focus:ring-green-400/30 transition-all duration-300 text-xs text-gray-800 appearance-none cursor-pointer font-medium">
                                    <option value="">選択</option>
                                    <option value="5分">⚡ 5分</option>
                                    <option value="15分">📊 15分</option>
                                    <option value="30分">📈 30分</option>
                                    <option value="60分">🎭 60分</option>
                                </select>
                            </div>
                        </div>

                        <!-- Industry -->
                        <div class="group relative">
                            <div class="absolute inset-0 bg-gradient-to-r from-purple-400/10 to-pink-400/10 blur-lg rounded-2xl group-hover:blur-md transition-all duration-300"></div>
                            <div class="relative bg-white/30 backdrop-blur-sm border border-white/40 rounded-2xl p-3 hover:bg-white/50 transition-all duration-300">
                                <label class="block text-xs font-semibold text-gray-700 mb-2 flex items-center">
                                    <span class="text-purple-500 text-sm mr-1">🏢</span>
                                    業界
                                </label>
                                <select id="industry" class="w-full px-2 py-1.5 bg-transparent border-none rounded-xl focus:ring-2 focus:ring-purple-400/30 transition-all duration-300 text-xs text-gray-800 appearance-none cursor-pointer font-medium">
                                    <option value="">選択</option>
                                    <option value="IT・技術">💻 IT</option>
                                    <option value="マーケティング">📢 マーケ</option>
                                    <option value="営業・セールス">💼 営業</option>
                                </select>
                            </div>
                        </div>

                        <!-- Tone -->
                        <div class="group relative">
                            <div class="absolute inset-0 bg-gradient-to-r from-orange-400/10 to-red-400/10 blur-lg rounded-2xl group-hover:blur-md transition-all duration-300"></div>
                            <div class="relative bg-white/30 backdrop-blur-sm border border-white/40 rounded-2xl p-3 hover:bg-white/50 transition-all duration-300">
                                <label class="block text-xs font-semibold text-gray-700 mb-2 flex items-center">
                                    <span class="text-orange-500 text-sm mr-1">🎨</span>
                                    トーン
                                </label>
                                <select id="tone" class="w-full px-2 py-1.5 bg-transparent border-none rounded-xl focus:ring-2 focus:ring-orange-400/30 transition-all duration-300 text-xs text-gray-800 appearance-none cursor-pointer font-medium">
                                    <option value="">選択</option>
                                    <option value="フォーマル">🎩 フォーマル</option>
                                    <option value="カジュアル">😊 カジュアル</option>
                                    <option value="データ重視">📊 データ</option>
                                    <option value="ストーリー重視">📖 ストーリー</option>
                                </select>
                            </div>
                        </div>

                        <!-- Objective -->
                        <div class="group relative">
                            <div class="absolute inset-0 bg-gradient-to-r from-emerald-400/10 to-teal-400/10 blur-lg rounded-2xl group-hover:blur-md transition-all duration-300"></div>
                            <div class="relative bg-white/30 backdrop-blur-sm border border-white/40 rounded-2xl p-3 hover:bg-white/50 transition-all duration-300">
                                <label class="block text-xs font-semibold text-gray-700 mb-2 flex items-center">
                                    <span class="text-emerald-500 text-sm mr-1">🎯</span>
                                    目的
                                </label>
                                <select id="objective" class="w-full px-2 py-1.5 bg-transparent border-none rounded-xl focus:ring-2 focus:ring-emerald-400/30 transition-all duration-300 text-xs text-gray-800 appearance-none cursor-pointer font-medium">
                                    <option value="">選択</option>
                                    <option value="説明・報告">📋 説明</option>
                                    <option value="提案・企画">💡 提案</option>
                                    <option value="教育・研修">🎓 教育</option>
                                    <option value="販売・営業">💰 販売</option>
                                </select>
                            </div>
                        </div>

                        <!-- Slide Count -->
                        <div class="group relative">
                            <div class="absolute inset-0 bg-gradient-to-r from-indigo-400/10 to-purple-400/10 blur-lg rounded-2xl group-hover:blur-md transition-all duration-300"></div>
                            <div class="relative bg-white/30 backdrop-blur-sm border border-white/40 rounded-2xl p-3 hover:bg-white/50 transition-all duration-300">
                                <label class="block text-xs font-semibold text-gray-700 mb-2 flex items-center">
                                    <span class="text-indigo-500 text-sm mr-1">📊</span>
                                    枚数
                                </label>
                                <select id="slideCount" class="w-full px-2 py-1.5 bg-transparent border-none rounded-xl focus:ring-2 focus:ring-indigo-400/30 transition-all duration-300 text-xs text-gray-800 appearance-none cursor-pointer font-medium">
                                    <option value="">選択</option>
                                    <option value="5-10枚">📄 5-10枚</option>
                                    <option value="10-20枚">📋 10-20枚</option>
                                    <option value="20-30枚">📚 20-30枚</option>
                                    <option value="30枚以上">📖 30枚以上</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Large Fields -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-4">
                        <!-- Visual Style -->
                        <div class="group relative">
                            <div class="absolute inset-0 bg-gradient-to-r from-pink-400/10 to-rose-400/10 blur-lg rounded-2xl group-hover:blur-md transition-all duration-300"></div>
                            <div class="relative bg-white/30 backdrop-blur-sm border border-white/40 rounded-2xl p-4 hover:bg-white/50 transition-all duration-300">
                                <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                                    <span class="text-pink-500 text-lg mr-2">🎨</span>
                                    ビジュアルスタイル
                                </label>
                                <select id="visualStyle" class="w-full px-3 py-2 bg-transparent border-none rounded-xl focus:ring-2 focus:ring-pink-400/30 transition-all duration-300 text-sm text-gray-800 appearance-none cursor-pointer font-medium">
                                    <option value="">選択してください</option>
                                    <option value="ミニマル">✨ ミニマル・シンプル</option>
                                    <option value="モダン">🔥 モダン・スタイリッシュ</option>
                                    <option value="クリエイティブ">🎭 クリエイティブ・カラフル</option>
                                    <option value="ビジネス">💼 ビジネス・プロフェッショナル</option>
                                    <option value="アカデミック">📚 アカデミック・学術的</option>
                                </select>
                            </div>
                        </div>

                        <!-- Language -->
                        <div class="group relative">
                            <div class="absolute inset-0 bg-gradient-to-r from-violet-400/10 to-purple-400/10 blur-lg rounded-2xl group-hover:blur-md transition-all duration-300"></div>
                            <div class="relative bg-white/30 backdrop-blur-sm border border-white/40 rounded-2xl p-4 hover:bg-white/50 transition-all duration-300">
                                <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                                    <span class="text-violet-500 text-lg mr-2">🌍</span>
                                    言語・地域
                                </label>
                                <select id="language" class="w-full px-3 py-2 bg-transparent border-none rounded-xl focus:ring-2 focus:ring-violet-400/30 transition-all duration-300 text-sm text-gray-800 appearance-none cursor-pointer font-medium">
                                    <option value="">選択してください</option>
                                    <option value="日本語">🇯🇵 日本語（国内向け）</option>
                                    <option value="英語">🇺🇸 English（国際向け）</option>
                                    <option value="バイリンガル">🌐 バイリンガル（日英併記）</option>
                                    <option value="韓国語">🇰🇷 한국어</option>
                                    <option value="中国語">🇨🇳 中文</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Generate Button -->
                    <div class="flex justify-center mt-6">
                        <button
                            type="submit"
                            id="generateBtn"
                            class="group relative bg-gradient-to-r from-blue-600 via-purple-600 to-blue-600 text-white py-3 px-8 rounded-2xl font-bold hover:shadow-xl hover:shadow-blue-500/25 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-500 flex items-center justify-center text-base overflow-hidden neon-glow transform hover:scale-105"
                            style="background-size: 200% 200%; background-position: 0% 0%;"
                        >
                            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"></div>
                            <span id="btn-icon" class="mr-2 text-lg group-hover:animate-bounce">✨</span>
                            <span id="btn-text">🚀 プレゼン資料を生成</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Generated Content Container -->
            <div id="result-container" class="hidden fade-in space-y-8">
                <!-- Reset Button -->
                <div class="flex justify-center mb-8">
                    <button
                        id="resetBtn"
                        class="group flex items-center px-8 py-4 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-2xl hover:from-gray-700 hover:to-gray-800 transition-all duration-300 font-semibold text-lg shadow-lg hover:shadow-xl hover:scale-105 neon-glow"
                    >
                        <span class="mr-3 text-2xl group-hover:animate-spin">🔄</span>
                        新しいプレゼンを作成
                    </button>
                </div>

                <!-- Generated Presentation Content -->
                <div id="presentation-content"></div>
            </div>
        </div>
    </div>

    <script>
        // Industry templates with specific content
        const industryTemplates = {
            'IT・技術': {
                structures: [
                    '現状課題の分析',
                    '技術的解決策',
                    'アーキテクチャ設計',
                    '実装・導入計画',
                    'ROI・成果測定'
                ],
                keyPointsTemplates: {
                    '現状課題の分析': [
                        'システムレスポンス時間の遅延（平均3.2秒→目標1秒以下）',
                        'セキュリティ脆弱性の発見（CVSSスコア7.5以上が5件）',
                        '運用コストの増大（月額予算20%オーバー）'
                    ],
                    '技術的解決策': [
                        'マイクロサービスアーキテクチャへの移行',
                        'Kubernetes基盤でのコンテナオーケストレーション',
                        'CI/CDパイプラインの自動化導入'
                    ],
                    'アーキテクチャ設計': [
                        'API Gateway + マイクロサービス構成',
                        'Redis/ElastiCacheによるキャッシュ層',
                        'RDS Multi-AZ + Read Replicaによる冗長化'
                    ],
                    '実装・導入計画': [
                        'フェーズ1：基盤構築（2ヶ月）',
                        'フェーズ2：アプリケーション移行（3ヶ月）',
                        'フェーズ3：運用最適化（1ヶ月）'
                    ],
                    'ROI・成果測定': [
                        'レスポンス時間67%改善による顧客満足度向上',
                        '運用コスト30%削減（月額150万円→105万円）',
                        'システム可用率99.9%達成'
                    ]
                },
                colorPalettes: [
                    ['#3B82F6', '#1E40AF', '#F3F4F6', '#374151']
                ]
            },
            'マーケティング': {
                structures: [
                    '市場環境分析',
                    'ターゲット戦略',
                    'マーケティング施策',
                    '実行・運用計画',
                    '効果測定・KPI'
                ],
                keyPointsTemplates: {
                    '市場環境分析': [
                        '市場規模：2024年度1,200億円（前年比108%成長）',
                        '競合3社のシェア分析と差別化ポイント',
                        '顧客ニーズの変化：デジタル化志向が75%増加'
                    ],
                    'ターゲット戦略': [
                        'プライマリ：30-45歳 年収600万円以上のビジネスパーソン',
                        'セカンダリ：25-35歳 IT・金融業界の意思決定者',
                        'ペルソナ：効率性重視、品質志向、ROI重視の特性'
                    ],
                    'マーケティング施策': [
                        'デジタル広告：Google/Facebook広告で月間100万PV獲得',
                        'コンテンツマーケティング：週2回のブログ＋月1回ウェビナー',
                        'インフルエンサーマーケティング：業界専門家5名と連携'
                    ],
                    '実行・運用計画': [
                        'Q1：ブランド認知向上キャンペーン（予算500万円）',
                        'Q2-Q3：リード獲得最大化（目標1,000件/月）',
                        'Q4：既存顧客ロイヤリティ向上施策'
                    ],
                    '効果測定・KPI': [
                        'ブランド認知度：25%→40%向上目標',
                        'リード獲得コスト：5,000円→3,500円に改善',
                        'コンバージョン率：2.1%→3.5%向上'
                    ]
                },
                colorPalettes: [
                    ['#EC4899', '#BE185D', '#FDF2F8', '#374151']
                ]
            },
            '営業・セールス': {
                structures: [
                    '現状・課題分析',
                    'ソリューション提案',
                    '導入効果・ROI',
                    '実装スケジュール',
                    '契約・次期ステップ'
                ],
                keyPointsTemplates: {
                    '現状・課題分析': [
                        '売上目標未達：四半期で計画比85%（1.5億円不足）',
                        '営業効率低下：商談成約率12%→目標20%',
                        'リードタイム長期化：受注まで平均45日かかる'
                    ],
                    'ソリューション提案': [
                        'CRM・SFAシステム導入による営業プロセス標準化',
                        'リード管理自動化でタイムリーなフォローアップ実現',
                        'データ分析による確度の高い見込み客の特定'
                    ],
                    '導入効果・ROI': [
                        '営業効率30%向上→年間売上1.8億円増加見込み',
                        'リードタイム25%短縮（45日→34日）',
                        'システム投資1,200万円→18ヶ月でペイバック'
                    ],
                    '実装スケジュール': [
                        '月次1：システム選定・契約締結',
                        '月次2-3：導入・設定・データ移行',
                        '月次4：トレーニング・本格運用開始'
                    ],
                    '契約・次期ステップ': [
                        'プロポーザル提出：2週間後（○月○日）',
                        '最終決裁・契約締結：1ヶ月後を目標',
                        'キックオフミーティング：契約後1週間以内'
                    ]
                },
                colorPalettes: [
                    ['#10B981', '#047857', '#F0FDF4', '#374151']
                ]
            }
        };

        // Form handling
        let isGenerating = false;
        
        document.getElementById('presentationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (isGenerating) return;
            
            const input = {
                theme: document.getElementById('theme').value.trim(),
                audience: document.getElementById('audience').value,
                duration: document.getElementById('duration').value,
                industry: document.getElementById('industry').value,
                tone: document.getElementById('tone').value,
                objective: document.getElementById('objective').value,
                slideCount: document.getElementById('slideCount').value,
                visualStyle: document.getElementById('visualStyle').value,
                language: document.getElementById('language').value
            };
            
            if (!input.theme) {
                alert('プレゼンテーマを入力してください');
                return;
            }
            
            generatePresentation(input);
        });
        
        // Reset functionality
        document.getElementById('resetBtn').addEventListener('click', function() {
            document.getElementById('result-container').classList.add('hidden');
            document.getElementById('form-container').classList.remove('hidden');
            document.getElementById('presentationForm').reset();
        });
        
        // Generate presentation
        async function generatePresentation(input) {
            if (isGenerating) return;
            
            isGenerating = true;
            const btn = document.getElementById('generateBtn');
            const btnText = document.getElementById('btn-text');
            const btnIcon = document.getElementById('btn-icon');
            
            // Update button to loading state
            btn.disabled = true;
            btn.style.backgroundPosition = '100% 0';
            btnIcon.innerHTML = '<div class="animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent inline-block"></div>';
            btnText.innerHTML = '<span class="animate-pulse">✨ AI が生成中...</span>';
            
            // Simulate generation time
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            const template = industryTemplates[input.industry] || industryTemplates['IT・技術'];
            
            const slides = template.structures.map(title => ({
                title,
                keyPoints: template.keyPointsTemplates[title] || [
                    `${title}に関する具体的な数値・データ`,
                    `${title}における課題解決のアプローチ`,
                    `${title}で期待される成果・効果`
                ],
                notes: `${title}について説明する際は、具体的な数値やデータを示し、聞き手にとっての価値や影響を明確に伝えることが重要です。質問がある場合は適切に回答し、次のステップへの合意形成を図りましょう。`
            }));
            
            // Visual style mapping
            const visualStyleMap = {
                'ミニマル': 'ミニマル・シンプル',
                'モダン': 'モダン・スタイリッシュ',
                'クリエイティブ': 'クリエイティブ・カラフル',
                'ビジネス': 'ビジネス・プロフェッショナル',
                'アカデミック': 'アカデミック・学術的'
            };
            
            // Language-specific title formatting
            const languageMap = {
                '日本語': '向けプレゼンテーション',
                '英語': ' Presentation',
                'バイリンガル': ' Presentation / プレゼンテーション',
                '韓国語': ' 프레젠테이션',
                '中国語': ' 演示文稿'
            };
            
            const titleSuffix = languageMap[input.language] || '向けプレゼンテーション';
            const layoutStyle = visualStyleMap[input.visualStyle] || 'モダンフラット';
            
            const presentation = {
                title: `${input.theme} - ${input.audience}${titleSuffix}`,
                structure: template.structures,
                slides,
                designSuggestions: {
                    colorPalette: template.colorPalettes[0],
                    fontSuggestion: 'Noto Sans JP',
                    layoutStyle: layoutStyle
                }
            };
            
            displayResult(presentation);
            
            // Reset button state
            btn.disabled = false;
            btn.style.backgroundPosition = '0% 0';
            btnIcon.innerHTML = '✨';
            btnText.innerHTML = '🚀 プレゼン資料を生成';
            isGenerating = false;
        }
        
        // Display generated result
        function displayResult(presentation) {
            const resultContainer = document.getElementById('result-container');
            const contentDiv = document.getElementById('presentation-content');
            
            contentDiv.innerHTML = `
                <div class="space-y-8 fade-in">
                    <!-- Header -->
                    <div class="glass-effect p-8 relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-400/20 to-purple-400/20 blur-3xl rounded-full"></div>
                        <div class="flex items-center justify-between mb-6 relative z-10">
                            <div class="flex items-center">
                                <div class="p-3 rounded-2xl bg-gradient-to-r from-blue-500 to-purple-600 mr-4 neon-glow">
                                    <span class="text-white text-2xl">📄</span>
                                </div>
                                <h2 class="text-3xl font-bold gradient-text">
                                    ${presentation.title}
                                </h2>
                            </div>
                            <button
                                onclick="exportPresentation()"
                                class="group flex items-center px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-2xl hover:shadow-lg hover:shadow-emerald-500/25 transition-all duration-300 font-medium hover:scale-105"
                            >
                                <span class="mr-2 group-hover:animate-bounce">📦</span>
                                全てエクスポート
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 relative z-10">
                            <!-- Structure -->
                            <div class="glass-card p-6">
                                <h3 class="text-xl font-bold mb-4 text-gray-800 flex items-center">
                                    <div class="p-2 rounded-xl bg-gradient-to-r from-blue-500 to-cyan-500 mr-3">
                                        <span class="text-white font-bold">📋</span>
                                    </div>
                                    プレゼン構成
                                </h3>
                                <div class="space-y-3">
                                    ${presentation.structure.map((item, index) => `
                                        <div class="group flex items-center p-4 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-2xl hover:from-blue-100 hover:to-cyan-100 transition-all duration-300 hover:scale-105 hover:shadow-md">
                                            <span class="bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold mr-4 group-hover:scale-110 transition-transform">
                                                ${index + 1}
                                            </span>
                                            <span class="font-semibold text-gray-800 group-hover:text-blue-700 transition-colors">${item}</span>
                                        </div>
                                    `).join('')}
                                </div>
                                <button
                                    onclick="copyToClipboard('${presentation.structure.map((item, index) => `${index + 1}. ${item}`).join('\\n')}', '構成')"
                                    class="mt-4 flex items-center px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-xl transition-all duration-300 font-medium hover:scale-105"
                                >
                                    <span class="mr-2">📋</span>
                                    構成をコピー
                                </button>
                            </div>

                            <!-- Design Suggestions -->
                            <div class="glass-card p-6">
                                <h3 class="text-xl font-bold mb-4 text-gray-800 flex items-center">
                                    <div class="p-2 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 mr-3">
                                        <span class="text-white">🎨</span>
                                    </div>
                                    デザイン提案
                                </h3>
                                <div class="space-y-6">
                                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-2xl">
                                        <p class="font-semibold text-gray-800 mb-3 flex items-center">
                                            🎨 カラーパレット
                                        </p>
                                        <div class="flex space-x-3">
                                            ${presentation.designSuggestions.colorPalette.map(color => `
                                                <div class="relative group">
                                                    <div
                                                        class="w-14 h-14 rounded-2xl shadow-lg border-3 border-white hover:scale-110 transition-transform duration-300 cursor-pointer"
                                                        style="background-color: ${color}"
                                                        title="${color}"
                                                    ></div>
                                                    <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 opacity-0 group-hover:opacity-100 transition-opacity bg-black text-white text-xs px-2 py-1 rounded">
                                                        ${color}
                                                    </div>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-2xl">
                                        <p class="font-semibold text-gray-800 mb-2 flex items-center">
                                            🔤 推奨フォント
                                        </p>
                                        <p class="text-lg font-medium text-gray-700 bg-white/50 px-4 py-2 rounded-xl">${presentation.designSuggestions.fontSuggestion}</p>
                                    </div>
                                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 p-4 rounded-2xl">
                                        <p class="font-semibold text-gray-800 mb-2 flex items-center">
                                            📝 レイアウトスタイル
                                        </p>
                                        <p class="text-lg font-medium text-gray-700 bg-white/50 px-4 py-2 rounded-xl">${presentation.designSuggestions.layoutStyle}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slides Detail -->
                    <div class="space-y-6">
                        <div class="text-center">
                            <h3 class="text-2xl font-bold gradient-text mb-2">📝 スライド詳細</h3>
                            <p class="text-gray-600">各スライドの詳細な内容とスピーカーノート</p>
                        </div>
                        ${presentation.slides.map((slide, index) => `
                            <div class="glass-effect p-8 hover:shadow-2xl transition-all duration-500 group relative overflow-hidden">
                                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"></div>
                                <div class="absolute -top-20 -right-20 w-40 h-40 bg-gradient-to-br from-blue-400/10 to-purple-400/10 blur-3xl rounded-full group-hover:scale-150 transition-transform duration-700"></div>
                                
                                <div class="flex items-center justify-between mb-6 relative z-10">
                                    <div class="flex items-center">
                                        <div class="flex items-center justify-center w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl mr-4 font-bold text-white text-lg group-hover:scale-110 transition-transform neon-glow">
                                            ${index + 1}
                                        </div>
                                        <h4 class="text-2xl font-bold text-gray-800 group-hover:text-blue-700 transition-colors">
                                            ${slide.title}
                                        </h4>
                                    </div>
                                    <button
                                        onclick="copyToClipboard(\`${slide.title}\\n\\nキーポイント:\\n${slide.keyPoints.map(p => `• ${p}`).join('\\n')}\\n\\nノート: ${slide.notes}\`, 'スライド${index + 1}')"
                                        class="p-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-2xl hover:shadow-lg hover:shadow-blue-500/25 transition-all duration-300 hover:scale-110 group/btn"
                                    >
                                        <span class="group-hover/btn:animate-pulse">📋</span>
                                    </button>
                                </div>
                                
                                <div class="mb-6 relative z-10">
                                    <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-2xl">
                                        <p class="font-bold text-gray-800 mb-4 flex items-center text-lg">
                                            ✨ キーポイント
                                        </p>
                                        <ul class="space-y-3">
                                            ${slide.keyPoints.map(point => `
                                                <li class="flex items-start">
                                                    <div class="w-2 h-2 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full mt-2 mr-4 flex-shrink-0"></div>
                                                    <span class="text-gray-700 font-medium leading-relaxed">${point}</span>
                                                </li>
                                            `).join('')}
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="relative z-10">
                                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 p-6 rounded-2xl">
                                        <p class="font-bold text-gray-800 mb-4 flex items-center text-lg">
                                            🎤 スピーカーノート
                                        </p>
                                        <p class="text-gray-700 bg-white/70 p-4 rounded-xl leading-relaxed font-medium shadow-sm">${slide.notes}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            // Hide form and show result
            document.getElementById('form-container').classList.add('hidden');
            resultContainer.classList.remove('hidden');
            
            // Store current presentation for export
            window.currentPresentation = presentation;
        }
        
        // Copy to clipboard function
        function copyToClipboard(text, label) {
            navigator.clipboard.writeText(text).then(() => {
                // Show toast notification
                showToast(`${label}をクリップボードにコピーしました`);
            }).catch(err => {
                console.error('Could not copy text: ', err);
                // Fallback for older browsers
                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast(`${label}をクリップボードにコピーしました`);
            });
        }
        
        // Export presentation function
        function exportPresentation() {
            if (!window.currentPresentation) return;
            
            const presentation = window.currentPresentation;
            const text = `
# ${presentation.title}

## 構成
${presentation.structure.map((item, index) => `${index + 1}. ${item}`).join('\n')}

## スライド詳細
${presentation.slides.map((slide, index) => `
### ${index + 1}. ${slide.title}
キーポイント:
${slide.keyPoints.map(point => `- ${point}`).join('\n')}

ノート: ${slide.notes}
`).join('\n')}

## デザイン提案
- カラーパレット: ${presentation.designSuggestions.colorPalette.join(', ')}
- フォント: ${presentation.designSuggestions.fontSuggestion}
- レイアウト: ${presentation.designSuggestions.layoutStyle}
            `;
            
            copyToClipboard(text.trim(), '完全版');
        }
        
        // Show toast notification
        function showToast(message) {
            // Remove existing toasts
            const existingToasts = document.querySelectorAll('.toast');
            existingToasts.forEach(toast => toast.remove());
            
            const toast = document.createElement('div');
            toast.className = 'toast fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 slide-in';
            toast.innerHTML = `
                <div class="flex items-center">
                    <span class="mr-2">✅</span>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(toast);
            
            // Remove toast after 3 seconds
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(-20px)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>